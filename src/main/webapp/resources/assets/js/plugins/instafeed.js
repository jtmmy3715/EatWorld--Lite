(function(){var a;a=function(){function b(c,g){var d,f;this.options={target:"instafeed",get:"popular",resolution:"thumbnail",sortBy:"none",links:!0,mock:!1,useHttp:!1};if(typeof c=="object"){for(d in c){f=c[d],this.options[d]=f}}this.context=g!=null?g:this,this.unique=this._genKey()}return b.prototype.hasNext=function(){return typeof this.context.nextUrl=="string"&&this.context.nextUrl.length>0},b.prototype.next=function(){return this.hasNext()?this.run(this.context.nextUrl):!1},b.prototype.run=function(f){var d,e,c;if(typeof this.options.clientId!="string"&&typeof this.options.accessToken!="string"){throw new Error("Missing clientId or accessToken.")}if(typeof this.options.accessToken!="string"&&typeof this.options.clientId!="string"){throw new Error("Missing clientId or accessToken.")}return this.options.before!=null&&typeof this.options.before=="function"&&this.options.before.call(this),typeof document!="undefined"&&document!==null&&(c=document.createElement("script"),c.id="instafeed-fetcher",c.src=f||this._buildUrl(),d=document.getElementsByTagName("head"),d[0].appendChild(c),e="instafeedCache"+this.unique,window[e]=new b(this.options,this),window[e].unique=this.unique),!0},b.prototype.parse=function(J){var ak,ab,ah,V,ai,ad,am,q,Q,X,F,U,af,H,an,Z,R,aq,B,ao,K,aj,ap,al,ac,G,W,Y,z,ae,aa,j,I;if(typeof J!="object"){if(this.options.error!=null&&typeof this.options.error=="function"){return this.options.error.call(this,"Invalid JSON data"),!1}throw new Error("Invalid JSON response")}if(J.meta.code!==200){if(this.options.error!=null&&typeof this.options.error=="function"){return this.options.error.call(this,J.meta.error_message),!1}throw new Error("Error from Instagram: "+J.meta.error_message)}if(J.data.length===0){if(this.options.error!=null&&typeof this.options.error=="function"){return this.options.error.call(this,"No images were returned from Instagram"),!1}throw new Error("No images were returned from Instagram")}this.options.success!=null&&typeof this.options.success=="function"&&this.options.success.call(this,J),this.context.nextUrl="",J.pagination!=null&&(this.context.nextUrl=J.pagination.next_url);if(this.options.sortBy!=="none"){this.options.sortBy==="random"?aa=["","random"]:aa=this.options.sortBy.split("-"),ae=aa[0]==="least"?!0:!1;switch(aa[1]){case"random":J.data.sort(function(){return 0.5-Math.random()});break;case"recent":J.data=this._sortBy(J.data,"created_time",ae);break;case"liked":J.data=this._sortBy(J.data,"likes.count",ae);break;case"commented":J.data=this._sortBy(J.data,"comments.count",ae);break;default:throw new Error("Invalid option for sortBy: '"+this.options.sortBy+"'.")}}if(typeof document!="undefined"&&document!==null&&this.options.mock===!1){Z=J.data,z=parseInt(this.options.limit,10),this.options.limit!=null&&Z.length>z&&(Z=Z.slice(0,z)),am=document.createDocumentFragment(),this.options.filter!=null&&typeof this.options.filter=="function"&&(Z=this._filter(Z,this.options.filter));if(this.options.template!=null&&typeof this.options.template=="string"){Q="",H="",ao="",I=document.createElement("div");for(F=0,ac=Z.length;F<ac;F++){U=Z[F],af=U.images[this.options.resolution];if(typeof af!="object"){throw ad="No image found for resolution: "+this.options.resolution+".",new Error(ad)}K=af.width,aq=af.height,B="square",K>aq&&(B="landscape"),K<aq&&(B="portrait"),an=af.url,X=window.location.protocol.indexOf("http")>=0,X&&!this.options.useHttp&&(an=an.replace(/https?:\/\//,"//")),H=this._makeTemplate(this.options.template,{model:U,id:U.id,link:U.link,type:U.type,image:an,width:K,height:aq,orientation:B,caption:this._getObjectProperty(U,"caption.text"),likes:U.likes.count,comments:U.comments.count,location:this._getObjectProperty(U,"location.name")}),Q+=H}I.innerHTML=Q,V=[],ah=0,ab=I.childNodes.length;while(ah<ab){V.push(I.childNodes[ah]),ah+=1}for(ap=0,G=V.length;ap<G;ap++){Y=V[ap],am.appendChild(Y)}}else{for(al=0,W=Z.length;al<W;al++){U=Z[al],R=document.createElement("img"),af=U.images[this.options.resolution];if(typeof af!="object"){throw ad="No image found for resolution: "+this.options.resolution+".",new Error(ad)}an=af.url,X=window.location.protocol.indexOf("http")>=0,X&&!this.options.useHttp&&(an=an.replace(/https?:\/\//,"//")),R.src=an,this.options.links===!0?(ak=document.createElement("a"),ak.href=U.link,ak.appendChild(R),am.appendChild(ak)):am.appendChild(R)}}j=this.options.target,typeof j=="string"&&(j=document.getElementById(j));if(j==null){throw ad='No element with id="'+this.options.target+'" on page.',new Error(ad)}j.appendChild(am),q=document.getElementsByTagName("head")[0],q.removeChild(document.getElementById("instafeed-fetcher")),aj="instafeedCache"+this.unique,window[aj]=void 0;try{delete window[aj]}catch(ag){ai=ag}}return this.options.after!=null&&typeof this.options.after=="function"&&this.options.after.call(this),!0},b.prototype._buildUrl=function(){var c,f,d;c="https://api.instagram.com/v1";switch(this.options.get){case"popular":f="media/popular";break;case"tagged":if(!this.options.tagName){throw new Error("No tag name specified. Use the 'tagName' option.")}f="tags/"+this.options.tagName+"/media/recent";break;case"location":if(!this.options.locationId){throw new Error("No location specified. Use the 'locationId' option.")}f="locations/"+this.options.locationId+"/media/recent";break;case"user":if(!this.options.userId){throw new Error("No user specified. Use the 'userId' option.")}f="users/"+this.options.userId+"/media/recent";break;default:throw new Error("Invalid option for get: '"+this.options.get+"'.")}return d=c+"/"+f,this.options.accessToken!=null?d+="?access_token="+this.options.accessToken:d+="?client_id="+this.options.clientId,this.options.limit!=null&&(d+="&count="+this.options.limit),d+="&callback=instafeedCache"+this.unique+".parse",d},b.prototype._genKey=function(){var c;return c=function(){return((1+Math.random())*65536|0).toString(16).substring(1)},""+c()+c()+c()+c()},b.prototype._makeTemplate=function(c,k){var f,h,d,j,g;h=/(?:\{{2})([\w\[\]\.]+)(?:\}{2})/,f=c;while(h.test(f)){j=f.match(h)[1],g=(d=this._getObjectProperty(k,j))!=null?d:"",f=f.replace(h,function(){return""+g})}return f},b.prototype._getObjectProperty=function(c,g){var d,f;g=g.replace(/\[(\w+)\]/g,".$1"),f=g.split(".");while(f.length){d=f.shift();if(!(c!=null&&d in c)){return null}c=c[d]}return c},b.prototype._sortBy=function(c,g,d){var f;return f=function(h,k){var j,l;return j=this._getObjectProperty(h,g),l=this._getObjectProperty(k,g),d?j>l?1:-1:j<l?1:-1},c.sort(f.bind(this)),c},b.prototype._filter=function(c,k){var f,h,d,j,g;f=[],h=function(i){if(k(i)){return f.push(i)}};for(d=0,g=c.length;d<g;d++){j=c[d],h(j)}return f},b}(),function(b,c){return typeof define=="function"&&define.amd?define([],c):typeof module=="object"&&module.exports?module.exports=c():b.Instafeed=c()}(this,function(){return a})}).call(this);